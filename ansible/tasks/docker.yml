---
#- name: 'DOCKER : copy docker env file'
#  ansible.builtin.template:
#    src: templates/.env.j2
#    dest: files/.env
#    mode: '0644'

- name: 'DOCKER : create volume'
  community.docker.docker_volume:
    name: '{{ item.name }}'
  loop:
    - { name: volume_koillection }
    - { name: volume_postgres }
  become: true

- name: 'DOCKER : create containers'
  community.docker.docker_compose_v2:
    project_src: files/
    pull: always
#    recreate: always
  become: true

- name: 'DOCKER : remove unused images'
  community.docker.docker_prune:
    images: true
  become: true

- name: 'DOCKER : wait for containers to start'
  ansible.builtin.wait_for:
    timeout: 2
